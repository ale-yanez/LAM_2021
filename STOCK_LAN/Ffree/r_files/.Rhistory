annotate("text", x=1986, y=0.24, label="Frms") +
scale_color_manual(name = '',
values = c('royalblue3','red'),
limits = c('actual', 'Frms'),
breaks = c('actual', 'Frms')) +
scale_linetype_manual(name = '',
values = c('solid','dotted'),
limits = c('actual', 'Frms'),
breaks = c('actual',  'Frms'))
p12_2 <- p12_2 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = '') + ylab('Mortalidad por Pesca (1/años)') + xlab('Años') +
scale_x_continuous(breaks=round(seq(min(yrs), 2020, by = 5),1))
p12_2
p_1 <- ggarrange(p11_2, p12_2,
ncol = 2, nrow = 1)
p13 <- ggplot(data = NULL, aes(x = yrs)) +
geom_line(aes(y = BD_est1/Brms, colour = 'actual', linetype = 'actual')) +
geom_line(aes(y = c(rep(1,42)), colour = 'Brms', linetype = 'Brms')) +
annotate("text", x=1986, y=0.9, label="Brms") +
scale_color_manual(name = '',
values = c('royalblue3', 'chartreuse3'),
limits = c('actual',  'Brms'),
breaks = c('actual',  'Brms')) +
scale_linetype_manual(name = '',
values = c('solid', 'twodash'),
limits = c('actual', 'Brms'),
breaks = c('actual', 'Brms'))
p13 <- p13 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = '') + ylab('BD/BDrms') + xlab('Años') +
scale_x_continuous(breaks=round(seq(min(yrs), 2020, by = 5),1))
p13
p14 <- ggplot(data = NULL, aes(x = yrs)) +
geom_line(aes(y = F_est1/Frms, colour = 'actual', linetype = 'actual')) +
geom_line(aes(y = c(rep(1,42)), colour = 'Frms', linetype = 'Frms')) +
annotate("text", x=1986, y=0.9, label="Frms") +
scale_color_manual(name = '',
values = c('royalblue3', 'red'),
limits = c('actual',  'Frms'),
breaks = c('actual',  'Frms')) +
scale_linetype_manual(name = '',
values = c('solid', 'dotted'),
limits = c('actual', 'Frms'),
breaks = c('actual', 'Frms'))
p14 <- p14 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = '') + ylab('F/Frms') + xlab('Años') +
scale_x_continuous(breaks=round(seq(min(yrs), 2020, by = 5),1))
p14
p_2 <- ggarrange(p13, p14, ncol = 2, nrow = 1)
plot <- ggarrange(p_1, p_2, ncol = 1, nrow = 2, align = "h", common.legend = F, legend = "bottom")
plot
#ggexport(plot, filename = "PBRs.pdf", width=7.5, height=6, dpi=300)
ggsave(plot, filename = "../../figures/logisticSel/PBRs.png", width=7.5, height=6, dpi=300)
VarPobl<- cbind(years=yrs, BD=BD_est1, BT=BT_est1, R=Rec_est1, F_est=F_est1, "F/FRMS"=F_est1/Frms, "BD/BDRMS"=BD_est1/Brms, "Y/BT"=predD/BT_est1)
write.table(VarPobl, '../../tables/logisticSel/Var_Pobl.txt', append = FALSE, sep = " ", dec = ".", row.names = TRUE, col.names = TRUE)
like<- cbind(CPUE=out1$LIKE[1], Crucero=out1$LIKE[2], Desemb=out1$LIKE[3], prop=out1$LIKE[4],
prop_mflo=out1$LIKE[5], prop_hflo=out1$LIKE[6], pobs_crum=out1$LIKE[7], pobs_cruh=out1$LIKE[8],
Ro=out1$LIKE[9], No_m=out1$LIKE[10], No_h=out1$LIKE[11], Lo_m=out1$LIKE[12], Lo_h=out1$LIKE[13], cvage_m=out1$LIKE[14], cvage_h=out1$LIKE[15])
like
write.table(like, '../../tables/logisticSel/verosimilitud.txt', append = FALSE, sep = " ", dec = ".", row.names = TRUE, col.names = TRUE)
estatus <- "Asesoría de agosto 2021"
years1       <- yrs
Bo1           <- out1$BDoLP              # Paso 4: Obtenci?n de Bo
BRMS1         <- Brms                       # Paso 5: Obtenci?n de Brms = 60%SPRo = 55%Bo
FRMS1         <- Frms
BLIM1         <- Bo1*0.275                        # Paso 6: Obtenci?n de Blim = 20%Bo
FLIM1         <- 1.27                             # Paso 6: Obtenci?n de Flim = 30%SPRo
SpB1          <- BD_est1                          # BD serie histórica de evaluación de stock
SpBSE1        <- stdBD1                         # desviaci?n estandar BD
ln_Fyr1       <- subset(std1,name=='log_Fh')$value      # logaritmo de Ft
ln_FSE1       <- subset(std1,name=='log_Fh')$std                           # logaritmo de la desviaci?n standar de Ft
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
rm(list=ls())
# Funciones y Directorios ####
library(rstudioapi)
library(ggplot2)
library(reshape)
library(ggpubr)
library(devtools)
devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/read.admb.R?raw=TRUE")
out1 <- read.admb("../../output/basetry/Lam")
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_basetry/fits.R", echo=TRUE)
df_Sel
rm(list=ls())
# Funciones y Directorios ####
library(rstudioapi)
library(ggplot2)
library(reshape)
library(ggpubr)
library(devtools)
# Getting the path of your current open file
#current_path = rstudioapi::getActiveDocumentContext()$path
#setwd(dirname(current_path ))
devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/read.admb.R?raw=TRUE")
out1 <- read.admb("../../output/base/Lam")
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_base/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_base/varpop.R", echo=TRUE)
rm(list=ls())
# Funciones y Directorios ####
library(rstudioapi)
library(ggplot2)
library(reshape)
library(ggpubr)
library(devtools)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/read.admb.R?raw=TRUE")
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_base/pbr_fases.R", echo=TRUE)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
source('~/Documents/Rwork/Functions/Funciones/Fn_DiagramaFase.R')
DiagramaFase(estatus,years1,SpB1,SpBSE1,ln_Fyr1,ln_FSE1,FRMS1,BRMS1,BLIM1,FLIM1,color=F,dir.1,etiqueta=F)
exp(10)
exp(-10)
exp(5)
exp(3)
rm(list=ls())
# Funciones y Directorios ####
library(rstudioapi)
library(ggplot2)
library(reshape)
library(ggpubr)
library(devtools)
# Getting the path of your current open file
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path ))
devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/read.admb.R?raw=TRUE")
system('mkdir ../../figures/Ffree') #otra opción
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
p12 <- ggplot(data = NULL, aes(x = yrs)) +
geom_line(aes(y = F_est1, colour = 'actual', linetype = 'actual')) +
#geom_line(aes(y = c(F_est2,NA), colour = 'anterior', linetype = 'anterior')) +
#geom_ribbon(data=NULL, aes(ymin=F1_lwr, ymax=F1_upr), fill = 'grey60', alpha = 0.4) +
#geom_ribbon(data=NULL, aes(ymin=c(F2_lwr,NA), ymax=c(F2_upr,NA)),fill = 'grey70', alpha = 0.4) +
geom_line(aes(y = c(rep(M,42)), colour = 'M', linetype = 'M')) +
geom_line(aes(y = c(rep(Frms,42)), colour = 'Frms', linetype = 'Frms')) +
annotate("text", x=2018, y=0.28, label="M") +
annotate("text", x=2018, y=0.42, label="Frms") +
scale_color_manual(name = '',
values = c('royalblue3', 'dodgerblue3','red'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms')) +
scale_linetype_manual(name = '',
values = c('solid', 'twodash','dotted'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms'))
p12 <- p12 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = 'none') + ylab('Mortalidad por Pesca (1/años)') + xlab('Años') +
scale_x_continuous(breaks=round(seq(1978, max(yrs), by = 6),1))
p12
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
p12 <- ggplot(data = NULL, aes(x = yrs)) +
geom_line(aes(y = F_est1, colour = 'actual', linetype = 'actual')) +
#geom_line(aes(y = c(F_est2,NA), colour = 'anterior', linetype = 'anterior')) +
geom_ribbon(data=NULL, aes(ymin=F1_lwr, ymax=F1_upr), fill = 'grey60', alpha = 0.4) +
#geom_ribbon(data=NULL, aes(ymin=c(F2_lwr,NA), ymax=c(F2_upr,NA)),fill = 'grey70', alpha = 0.4) +
geom_line(aes(y = c(rep(M,42)), colour = 'M', linetype = 'M')) +
geom_line(aes(y = c(rep(Frms,42)), colour = 'Frms', linetype = 'Frms')) +
annotate("text", x=2018, y=0.28, label="M") +
annotate("text", x=2018, y=0.42, label="Frms") +
scale_color_manual(name = '',
values = c('royalblue3', 'dodgerblue3','red'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms')) +
scale_linetype_manual(name = '',
values = c('solid', 'twodash','dotted'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms'))
p12 <- p12 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = 'none') + ylab('Mortalidad por Pesca (1/años)') + xlab('Años') +
scale_x_continuous(breaks=round(seq(1978, max(yrs), by = 6),1))
p12
p12 <- ggplot(data = NULL, aes(x = yrs)) +
geom_line(aes(y = F_est1, colour = 'actual', linetype = 'actual')) +
#geom_line(aes(y = c(F_est2,NA), colour = 'anterior', linetype = 'anterior')) +
#geom_ribbon(data=NULL, aes(ymin=F1_lwr, ymax=F1_upr), fill = 'grey60', alpha = 0.4) +
#geom_ribbon(data=NULL, aes(ymin=c(F2_lwr,NA), ymax=c(F2_upr,NA)),fill = 'grey70', alpha = 0.4) +
geom_line(aes(y = c(rep(M,42)), colour = 'M', linetype = 'M')) +
geom_line(aes(y = c(rep(Frms,42)), colour = 'Frms', linetype = 'Frms')) +
annotate("text", x=2018, y=0.28, label="M") +
annotate("text", x=2018, y=0.42, label="Frms") +
scale_color_manual(name = '',
values = c('royalblue3', 'dodgerblue3','red'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms')) +
scale_linetype_manual(name = '',
values = c('solid', 'twodash','dotted'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms'))
p12 <- p12 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = 'none') + ylab('Mortalidad por Pesca (1/años)') + xlab('Años') +
scale_x_continuous(breaks=round(seq(1978, max(yrs), by = 6),1))
p12
F_est1
F_est1
#BD_est2       <- subset(std2,name=='BD')$value
F_est1        <- exp(subset(std1,name=='log_Fh')$value)
F_est1
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
exp(-1)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
p12 <- ggplot(data = NULL, aes(x = yrs)) +
geom_line(aes(y = F_est1, colour = 'actual', linetype = 'actual')) +
#geom_line(aes(y = c(F_est2,NA), colour = 'anterior', linetype = 'anterior')) +
geom_ribbon(data=NULL, aes(ymin=F1_lwr, ymax=F1_upr), fill = 'grey60', alpha = 0.4) +
#geom_ribbon(data=NULL, aes(ymin=c(F2_lwr,NA), ymax=c(F2_upr,NA)),fill = 'grey70', alpha = 0.4) +
geom_line(aes(y = c(rep(M,42)), colour = 'M', linetype = 'M')) +
geom_line(aes(y = c(rep(Frms,42)), colour = 'Frms', linetype = 'Frms')) +
annotate("text", x=2018, y=0.28, label="M") +
annotate("text", x=2018, y=0.42, label="Frms") +
scale_color_manual(name = '',
values = c('royalblue3', 'dodgerblue3','red'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms')) +
scale_linetype_manual(name = '',
values = c('solid', 'twodash','dotted'),
limits = c('actual', 'M', 'Frms'),
breaks = c('actual', 'M', 'Frms'))
p12 <- p12 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = 'none') + ylab('Mortalidad por Pesca (1/años)') + xlab('Años') +
scale_x_continuous(breaks=round(seq(1978, max(yrs), by = 6),1))
p12
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/varpop.R", echo=TRUE)
rm(list=ls())
# Funciones y Directorios ####
library(rstudioapi)
library(ggplot2)
library(reshape)
library(ggpubr)
library(devtools)
# Getting the path of your current open file
#current_path = rstudioapi::getActiveDocumentContext()$path
#setwd(dirname(current_path ))
devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/read.admb.R?raw=TRUE")
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/r_Ffree/fits.R", echo=TRUE)
rm(list=ls())
# Funciones y Directorios ####
library(rstudioapi)
library(ggplot2)
library(reshape)
library(ggpubr)
library(devtools)
# Getting the path of your current open file
#current_path = rstudioapi::getActiveDocumentContext()$path
#setwd(dirname(current_path ))
devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/read.admb.R?raw=TRUE")
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/LogSel_Ffree/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/LogSel_Ffree/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/LogSel_Ffree/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/LogSel_Ffree/fits.R", echo=TRUE)
source("~/GitHub/LAM_2021/STOCK_LAN/rfiles/LogSel_Ffree/fits.R", echo=TRUE)
rm(list=ls())
library(stringr)
library(knitr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(R2admb)
library(reshape2)
library(ggpubr)
library(plyr)
#devtools::source_url("https://github.com/ale-yanez/RFunctions/blob/master/multiplot.R?raw=TRUE")
source('~/Documents/Rwork/Functions/functions.R')
source('~/Documents/Rwork/Functions/read.report.R')
#dir.1<-'~/Documents/Rwork/IFOP/LAm_2020/Taller_Datos'
#dir.2<-'~/Documents/ADMwork/IFOP/2019/Lama_model/Cons_2003/norte/Lamnor2003'
#dir.3<-'~/Documents/ADMwork/IFOP/2019/Lama_model/Cons_2003/sur/Lamsur2003'
# Lee datos UPN
#setwd(dir.2)
# dat.file_nor    = "lamnor2003.dat" #Cambiar despues por info actualizada y borrar esto
# dat1_nor        <- lisread(paste(dir.2,dat.file_nor, sep='/'));
dat1_nor        <- lisread("../STOCK_LAN/input/stock_LAN.dat");
# Lee datos UPN
#setwd(dir.2)
# dat.file_nor    = "lamnor2003.dat" #Cambiar despues por info actualizada y borrar esto
# dat1_nor        <- lisread(paste(dir.2,dat.file_nor, sep='/'));
dat1_nor        <- lisread("../STOCK_LAN/input/base/stock_LAN.dat");
names(dat1_nor) <- str_trim(names(dat1_nor), side="right")
dat_nor         <- dat1_nor
# Lee datos UPS
# setwd(dir.3)
# dat.file_sur    = "lamsur2003.dat" #Cambiar despues por info actualizada y borrar esto
# dat1_sur        <- lisread(paste(dir.3,dat.file_sur, sep='/'));
dat1_sur        <- lisread("../STOCK_LAS/input/stock_LAS.dat");
names(dat1_sur) <- str_trim(names(dat1_sur), side="right")
dat_sur         <- dat1_sur
# DATOS NORTE
# ============================================================================== #
yrs_n  <- dat_nor$Ind[,1]
years_n  <- dat_nor$Ind[,1]
nyrs_n <- length(yrs_n)
age_n    <- dat_nor$edades
nage_n   <- dat_nor$nages
ntalla_n  <- dat_nor$ntallas
tallas_n <- dat_nor$tallas
#Indices
mydat_nor <-  dat_nor$Ind[,c(1,2,3,4,5)] #; mydat_nor[mydat_nor==0] <- NA
myd_nor   <-  data.frame(mydat_nor)
myd_nor$periodo <- c(rep('A', 22), rep('B',20))
names <-  c('yrs', 'desem','cpue','Bcru','ph','Periodo')
colnames(myd_nor) <- names
#Observado
cpue_n <- myd_nor$cpue; cpue_n[cpue_n <= 0.01]   <-NA
Bcru_n <- myd_nor$Bcru ; Bcru_n[Bcru_n <= 1]  <-NA
# Confidence Intervals
cvcpue_n        <- rep(0.15,nyrs_n)
cvBcru_n        <- rep(0.30,nyrs_n)
obsC95i_n <- cpue_n*exp(-1.96*cvcpue_n); obsC95s_n <-cpue_n*exp(1.96*cvcpue_n)
obsS95i_n <- Bcru_n*exp(-1.96*cvBcru_n); obsS95s_n <-Bcru_n*exp(1.96*cvBcru_n)
# DATOS SUR
# ============================================================================== #
yrs_s     <- dat_sur$Ind[,1]
years_s   <- dat_sur$Ind[,1]
nyrs_s    <- length(yrs_s)
age_s     <- dat_sur$edades
nage_s    <- dat_sur$nages
ntalla_s  <- dat_sur$ntallas
tallas_s  <- dat_sur$tallas
#Indices
mydat_sur <-  dat_sur$Ind[,c(1,2,3,4,5)] #; mydat_sur[mydat_sur==0] <- NA
myd_sur   <-  data.frame(mydat_sur)
myd_sur$periodo <- c(rep('A', 22), rep('B',20))
names <-  c('yrs', 'desem','cpue','Bcru','ph','Periodo')
colnames(myd_sur) <- names
#Observado
cpue_s <- myd_sur$cpue; cpue_s[cpue_s <= 0.01]   <-NA
Bcru_s <- myd_sur$Bcru ; Bcru_s[Bcru_s <= 1]  <-NA
# Confidence Intervals
cvcpue_s        <- rep(0.15,nyrs_s)
cvBcru_s        <- rep(0.30,nyrs_s)
obsC95i_s <- cpue_s*exp(-1.96*cvcpue_s); obsC95s_s <-cpue_s*exp(1.96*cvcpue_s)
obsS95i_s <- Bcru_s*exp(-1.96*cvBcru_s); obsS95s_s <-Bcru_s*exp(1.96*cvBcru_s)
# Desembarque ####
land<-data.frame(years_s, c(myd_nor$desem + myd_sur$desem), myd_sur$Periodo)
names(land) <-  c('yrs', 'desem', 'Periodo')
#head(land,10)
# tail(land)
# summary(land)
#land$yrs <- as.factor(land$yrs)
#land$yrs <- land$yrs
land$Periodo <- as.factor(land$Periodo)
#head(land,10)
bp <- ggbarplot(land, x = "yrs", y = "desem",
fill = "Periodo",           # change fill color by cyl
color = "white",            # Set bar border colors to white
palette = 'jco',            # jco journal color palett. see ?ggpar
#palette = c("dodgerblue3","gold2","gold2"),            # jco journal color palett. see ?ggpar
#sort.val = "asc",           # Sort the value in ascending order
sort.by.groups = FALSE,      # Sort inside each group
x.text.angle = 90           # Rotate vertically x axis texts
)
bp <- bp + font("x.text", size = 7) + scale_x_discrete(breaks=round(seq(min(land$yrs)-1, 2020, by = 2),1)) +
theme(legend.position = 'bottom') + xlab('Años') + ylab('Desembarque (t)')
bp
ggsave(bp, file='Figs/Fig1_Desem_Total.png', width=7.5, height=5, dpi=300)
# op<-par(no.readonly=TRUE)
# ps.options(horizontal=F,bg="white",onefile=FALSE,paper="special")
# postscript("F1_ControlCuota.eps",height=8,width=12)
# bp
# dev.off()
#Biomasa Cruceros
p5 <-  ggplot(myd_nor, aes(x=yrs_n))+
geom_point(aes(y= Bcru, colour="Biomasa Crucero"), size = 2, shape = 21) +
geom_errorbar(aes(ymin = obsS95i_n, ymax = obsS95s_n), colour='black', width=0.6) +
scale_colour_manual(name='', values=c('Biomasa Crucero'='black'), guide='legend') +
guides(colour = guide_legend(override.aes = list(linetype=c(0), shape=c(21)))) +
xlab('Años') + scale_x_continuous(breaks=round(seq(min(yrs_n)-1, max(yrs_n), by = 3),1)) +
ylab('Biomasa Crucero (t)') + #scale_y_continuous(breaks=round(seq(0, 3, by = 0.5),1)) +
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = 'bottom')  + theme(legend.title=element_blank())
p5
ggsave(p5, file='Figs/Fig3_Crucero_LAmNor.png', width=7.5, height=5, dpi=300)
df_prop <- data.frame(c(rep(yrs_n,2)), c(myd_nor$ph, (1-myd_nor$ph)), c(rep('hembras',42), rep(' machos',42)))
names <-  c('yrs', 'Prop', 'Sexo')
colnames(df_prop) <- names
p6 <- ggplot(df_prop, aes(fill=Sexo, y=Prop, x=yrs)) +
geom_bar(stat="identity", position = "fill") +
scale_fill_manual("", values = c("hembras" = "gold2", " machos" = "grey")) +
xlab('Años') + scale_x_continuous(breaks=round(seq(min(yrs_n)-1, 2020, by = 3),1)) +
ylab('Proporción') + scale_y_continuous(breaks=round(seq(0, 1, by = 0.1),1)) +
theme_bw() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.position = 'bottom')  + theme(legend.title=element_blank())
p6 + annotate("segment", x=1979, xend=2020, y=0.5, yend=0.5, colour="red", linetype="dashed")
ggsave(p6, file='Figs/Fig4_PropSexual_LAmNor.png', width=7.5, height=5, dpi=300)
df1 <- data.frame(dat_nor$ETflom)
names <-  c(tallas_n)
colnames(df1) <- names
df1$yr <- as.factor(yrs_n)
df1 <- df1[-c(3:8, 29), ]
#length(df1[, 34])
d <- melt(df1)
#head(d)
colnames(d) <- c('yr', 'Tallas', 'value')
dfl <- data.frame(d$yr, d$Tallas, d$value)
#head(dfl)
colnames(dfl) <- c('yrs', 'Tallas', 'pobs')
#Plotting
p7 <- ggplot(data=dfl, aes(x=Tallas, y=pobs)) +
geom_bar(stat="identity", colour='grey') + #xlab('Tallas')
ylab('Proporción') + theme_bw() + theme(legend.position ='none') +
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),axis.text=element_text(size=8))
p7 <- p7 + facet_wrap(~ yrs, dir = 'v') + scale_x_discrete('Tallas', breaks = seq(10, 52, by= 6))# + scale_y_continuous(limits=c(0,0.16))
p7
ggsave(p7, file='Figs/Fig5_CompsFleetM_LAmNor.png', width=7.5, height=5, dpi=300)
# Hembras Flota Norte
df2 <- data.frame(dat_nor$ETfloh)
names <-  c(tallas_n)
colnames(df2) <- names
df2$yr <- as.factor(yrs_n)
df2 <- df2[-c(3:8, 29), ]
#length(df1[, 34])
d2 <- melt(df2)
#head(d)
colnames(d2) <- c('yr', 'Tallas', 'value')
dfl2 <- data.frame(d2$yr, d2$Tallas, d2$value)
#head(dfl)
colnames(dfl2) <- c('yrs', 'Tallas', 'pobs')
#Plotting
p8 <- ggplot(data=dfl2, aes(x=Tallas, y=pobs)) +
geom_bar(stat="identity", colour='grey') + #xlab('Tallas')
ylab('Proporción') + theme_bw() + theme(legend.position ='none') +
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),axis.text=element_text(size=7))
p8 <- p8 + facet_wrap(~ yrs, dir = 'v') + scale_x_discrete('Tallas', breaks = seq(10, 52, by= 6))# + scale_y_continuous(limits=c(0,0.16))
p8
ggsave(p8, file='Figs/Fig6_CompsFleetH_LAmNor.png', width=7.5, height=5, dpi=300)
df3 <- data.frame(dat_nor$ETcrum)
names <-  c(tallas_n)
colnames(df3) <- names
df3$yr <- as.factor(yrs_n)
df3 <- df3[-c(1:14, 16, 26), ]
#length(df1[, 34])
d3 <- melt(df3)
#head(d)
colnames(d3) <- c('yr', 'Tallas', 'value')
dfl3 <- data.frame(d3$yr, d3$Tallas, d3$value)
#head(dfl)
colnames(dfl3) <- c('yrs', 'Tallas', 'pobs')
#Plotting
p9 <- ggplot(data=dfl3, aes(x=Tallas, y=pobs)) +
geom_bar(stat="identity", colour='grey') + #xlab('Tallas')
ylab('Proporción') + theme_bw() + theme(legend.position ='none') +
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),axis.text=element_text(size=10))
p9 <- p9 + facet_wrap(~ yrs, dir = 'v') + scale_x_discrete('Tallas', breaks = seq(10, 52, by= 6))# + scale_y_continuous(limits=c(0,0.16))
p9
ggsave(p9, file='Figs/Fig7_CompsSurvM_LAmNor.png', width=7.5, height=5, dpi=300)
df4 <- data.frame(dat_nor$ETcruh)
names <-  c(tallas_n)
colnames(df4) <- names
df4$yr <- as.factor(yrs_n)
df4 <- df4[-c(1:14, 16, 26), ]
#length(df1[, 34])
d4 <- melt(df4)
#head(d)
colnames(d4) <- c('yr', 'Tallas', 'value')
dfl4 <- data.frame(d4$yr, d4$Tallas, d4$value)
#head(dfl)
colnames(dfl4) <- c('yrs', 'Tallas', 'pobs')
#Plotting
p10 <- ggplot(data=dfl4, aes(x=Tallas, y=pobs)) +
geom_bar(stat="identity", colour='grey') + #xlab('Tallas')
ylab('Proporción') + theme_bw() + theme(legend.position ='none') +
theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(),axis.text=element_text(size=10))
p10 <- p10 + facet_wrap(~ yrs, dir = 'v') + scale_x_discrete('Tallas', breaks = seq(10, 52, by= 6))# + scale_y_continuous(limits=c(0,0.16))
p10
ggsave(p10, file='Figs/Fig8_CompsSurvH_LAmNor.png', width=7.5, height=5, dpi=300)
# Pesos Medios
Wt_m <- dat_nor$Wt_m
Wt_h <- dat_nor$Wt_h
#Plotting Flota
p11 <- ggplot(NULL, aes(x = tallas_n)) +
geom_line(aes(y = Wt_m, colour = 'Machos', linetype = 'Machos')) +
geom_line(aes(y = Wt_h, colour = 'Hembras', linetype = 'Hembras')) +
scale_color_manual(name = '', values = c('gold2', 'grey')) +      #, limits = c('Machos', 'Hembras'), breaks = c('Machos', 'Hembras')) +
scale_linetype_manual(name = '', values = c('solid', 'solid'))    # , limits = c('Machos', 'Hembras'), breaks = c('Machos', 'Hembras'))
p11 <- p11 + theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.text=element_text(size=8)) +
theme(legend.title=element_blank()) + theme(legend.position = 'bottom') + theme(legend.text=element_text(size=12)) +
ylab('Peso (g)') + scale_x_continuous('Tallas (mm)', breaks = seq(10, 52, by= 6)) #+ ggtitle('Flota')
p11
ggsave(p11, file='Figs/Fig9_Wm_LAmNor.png', width=7.5, height=5, dpi=300)
